{% extends "base.html" %}
{% block content %}
<h2>{{ group.name }} Feed</h2>

<!-- Post to Group -->
<form method="post" action="{% url 'create_group_post' group.id %}">
    {% csrf_token %}
    <textarea name="content" placeholder="Share something with the group"></textarea>
    <button type="submit">Post</button>
</form>

{% for post in posts %}
  <div>
    <p><strong>{{ post.author.username }}</strong> posted: {{ post.content }}</p>
    <p>Likes: {{ post.likes|length }}</p>
    <a href="{% url 'like_post' post.id %}">Like</a>

    <!-- Comments -->
    <div>
      {% for comment in comments_by_post|get_item:post.id|stringformat:"s" %}
        <p><strong>{{ comment.author.username }}:</strong> {{ comment.content }}</p>
      {% endfor %}
    </div>

    <!-- Comment Form -->
    <form method="post" action="{% url 'add_comment' %}">
        {% csrf_token %}
        <input type="hidden" name="post_id" value="{{ post.id }}">
        <input type="text" name="comment_content" placeholder="Add a comment">
        <button type="submit">Comment</button>
    </form>
  </div>
  <hr>
{% endfor %}
{% endblock %}